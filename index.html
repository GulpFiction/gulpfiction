<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>Gulp Fiction</title>
        <link rel="stylesheet" href="app.css" />
        <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/zeroclipboard/1.1.7/ZeroClipboard.min.js"></script>
        <script type="text/javascript">
          (function(d) {
            var config = {
              kitId: 'spc1sua',
              scriptTimeout: 3000
            },
            h=d.documentElement,t=setTimeout(function(){h.className=h.className.replace(/\bwf-loading\b/g,"")+" wf-inactive";},config.scriptTimeout),tk=d.createElement("script"),f=false,s=d.getElementsByTagName("script")[0],a;h.className+=" wf-loading";tk.src='//use.typekit.net/'+config.kitId+'.js';tk.async=true;tk.onload=tk.onreadystatechange=function(){a=this.readyState;if(f||a&&a!="complete"&&a!="loaded")return;f=true;clearTimeout(t);try{Typekit.load(config)}catch(e){}};s.parentNode.insertBefore(tk,s)
          })(document);
        </script>
        <script src="components.js"></script>
        <script src="app.js"></script>
        <script src="views.js"></script>
        <link rel="icon" type="image/gif" href="/img/logo.gif?v=2" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    </head>

    <body ng-app="app" ng-controller="appController" ng-class="{'show-help': showsHelp }">
        <keyup-events></keyup-events>
        <header>

            <h1>
                <a ng-click="showTeaser()" data-tooltip="Show teaser" data-tooltip-options="right">
                    <img src="/img/logo.gif" class="logo">
                    <span class="gulp">Gulp</span>
                    <span class="fiction">Fiction</span>
                </a>
            </h1>

            <project-picker projects="projects" current-project="project" on-switch-project="switchToProject(project)"></project-picker>

            <div class="options">
                <div class="options-project"
                data-tooltip="Project Actions"
                data-tooltip-options="left only-help">
                    <button ng-click="confirmDeleteProject()" data-tooltip-options="oneline bottom" data-tooltip="Remove project" data-tooltip-options="oneline"><i class="fa fa-times-circle"></i>
                    </button>

                    <button ng-click="openExportProject(project)" data-tooltip-options="oneline bottom" data-tooltip="Export gulpfile.js" data-tooltip-options="oneline"><i class="fa fa-cloud-download"></i>
                    </button>

                    <button ng-click="openExportToDropbox(project)" data-tooltip-options="oneline bottom" data-tooltip="Export gulpfile.js to Dropbox" data-tooltip-options="oneline"><i class="fa fa-dropbox"></i>
                    </button>
                </div>

                <div class="options-app"
                data-tooltip="App Actions"
                data-tooltip-options="bottom only-help oneline">
                    <button ng-click="addProject()" data-tooltip-options="oneline bottom" data-tooltip="Add project"><i class="fa fa-plus-circle"></i></button>
                    <button ng-click="toggleHelp()"><i class="fa fa-question-circle"></i></button>
                </div>
            </div>
        </header>

        <div ng-view></div>

        <lightbox is-active="showsTeaser" show-close="true">
            <h1>Gulp Fiction - the Royale with cheese for your build workflow!</h1>
            <h3>- Easy visual editing of your gulp file!</h3>
            <h3>- Export your generated gulp file to your Dropbox account or copy it!</h3>
            <h3>- Search for steps and build tasks!</h3>

            <h3>More:</h3>
            <ul>
                <li><a href="http://gulpjs.com/" targe="_blank">What the f*** is a gulp file?</a></li>
            </ul>
            <button ng-click="on">Look at Gulp Fiction's own build file</button>
            <button ng-click="on">Start with an all fresh project</button>

        </lightbox>

        <lightbox is-active="showsDropboxExport" show-close="true">
            <h1>Want to use Dropbox? You're one smart motherfu<i class="fa fa-asterisk"></i><i class="fa fa-asterisk"></i><i class="fa fa-asterisk"></i>r.</h1>

            <span ng-if="isDropboxAuthenticated"> {{dbAccountInfo.display_name}} is connected <button ng-click="logoutDropbox()">Logout</button></span>

            <h3>Export your file to DropBox and link it with your project</h3>

            <ol>
                <li>Export your generated gulp-file to your Dropbox</li>
                <li>Create a symbolic link to your Dropbox:<br/>
                    <pre><code>$ ln -s ~/Dropbox/gulp-fiction/{{project.id}}.js gulpfile.js</code></pre>
                </li>
                <li>There is no third step!</li>
            </ol>
            <br>

            <div>
                <button ng-if="!isDropboxAuthenticated" ng-click="connectDb()" class="button"><i class="fa fa-dropbox"></i>
                    <span> Connect to Dropbox</span>
                </button>

                <button style="font-size:2rem;" ng-show="isDropboxAuthenticated && !showExportProgress" ng-click="exportProjectToDropbox(project)" class="button">
                    <i class="fa fa-dropbox"></i> Save</button>

                <button ng-if="showExportProgress" disabled><i class="fa fa-spinner fa-spin" class="button"></i> Exportingâ€¦</button>

                <span ng-if="showExportDone"><i class="fa fa-check"></i> Saved</span>

            </div>
        </lightbox>


        <lightbox is-active="showsExport" show-close="true">
            <h1>Any time of the day is a good time for pie!</h1>
            <div class="export-left">
                <h3 clip-copy="currentExportContent">Copy by clicking in here</h3>

            </div>
            <div ui-ace readonly="true" style="height:40rem" ng-model="currentExportContent"></div>

        </lightbox>


        <confirm-lightbox   is-active="confirmDeleteProjectActive"
                            name="{{project.name}}"
                            on-confirm="removeProject(toDeleteItem)">
            <h1>Delete {{name}}?</h1>
        </confirm-lightbox>

    </body>
</html>